<!-- templates/auth/logout.html -->
{% extends 'accounts/auth_base.html' %}
{% load static %}


{% block content %}
<div class="flex flex-col items-center justify-center min-h-screen hero-pattern theme-transition py-12">
    <div class="w-full max-w-md bg-white dark:bg-slate-800 rounded-xl shadow-xl overflow-hidden theme-transition p-8 text-center">
        <div class="w-20 h-20 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center mx-auto mb-6">
            <i class="fas fa-user text-blue-500 dark:text-blue-400 text-4xl"></i>
        </div>
        
        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-4">Logout</h2>
        <p class="text-gray-600 dark:text-slate-300 mb-6">You are logged in as {{ request.user.username }}</p>
        <p class="text-gray-600 dark:text-slate-300 mb-6">Are you sure you want to logout?</p>
        
        <form method="POST" action="{% url 'logout' %}" id="logout-form">
            {% csrf_token %}
            <div class="form-control mt-6">
                <button type="submit" class="btn btn-primary mb-4">Yes, Logout</button>
                <a href="{% url 'home' %}" class="btn btn-outline dark:border-slate-400 dark:text-white">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // AJAX form submission
    document.getElementById('logout-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const form = e.target;
        const formData = new FormData(form);
        
        fetch(form.action, {
            method: 'POST',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': formData.get('csrfmiddlewaretoken')
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = data.redirect_url;
            } else {
                // Handle errors
                alert('Logout failed. Please try again.');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            form.submit(); // Fallback to normal form submission
        });
    });
</script>
{% endblock %}
