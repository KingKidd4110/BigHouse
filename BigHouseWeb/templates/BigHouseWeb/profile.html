<!-- templates/profile.html -->
{% extends 'BigHouseWeb/base.html' %}
{% load static %}

{% block title %}BigHouse - My Profile{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex flex-col md:flex-row gap-8">
        <!-- Profile Card -->
        <div class="w-full md:w-1/3">
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 theme-transition">
                <div class="flex flex-col items-center mb-6">
                    <div class="w-24 h-24 rounded-full bg-gray-200 dark:bg-slate-700 mb-4 overflow-hidden">
                        {% if user_profile.profile_picture %}
                            <img src="{{ user_profile.profile_picture.url }}" alt="Profile Picture" class="w-full h-full object-cover">
                        {% else %}
                            <div class="w-full h-full flex items-center justify-center">
                                <i class="fas fa-user text-4xl text-gray-400"></i>
                            </div>
                        {% endif %}
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">{{ user.username }}</h2>
                    <p class="text-gray-600 dark:text-slate-300 capitalize">{{ user_profile.user_type }}</p>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-semibold text-gray-500 dark:text-slate-400 mb-1">Email</h3>
                        <p class="text-gray-800 dark:text-white">{{ user.email }}</p>
                    </div>
                    
                    {% if user_profile.phone_number %}
                    <div>
                        <h3 class="text-sm font-semibold text-gray-500 dark:text-slate-400 mb-1">Phone</h3>
                        <p class="text-gray-800 dark:text-white">{{ user_profile.phone_number }}</p>
                    </div>
                    {% endif %}
                    
                    {% if house %}
                    <div>
                        <h3 class="text-sm font-semibold text-gray-500 dark:text-slate-400 mb-1">Building</h3>
                        <p class="text-gray-800 dark:text-white">{{ house.building.name }}</p>
                    </div>
                    
                    <div>
                        <h3 class="text-sm font-semibold text-gray-500 dark:text-slate-400 mb-1">House Number</h3>
                        <p class="text-gray-800 dark:text-white">{{ house.house_number }}</p>
                    </div>
                    
                    <div>
                        <h3 class="text-sm font-semibold text-gray-500 dark:text-slate-400 mb-1">Rent Amount</h3>
                        <p class="text-gray-800 dark:text-white">${{ house.rent_amount }}/month</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="w-full md:w-2/3">
            <!-- Rent Status -->
            {% if house %}
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 mb-6 theme-transition">
                <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Rent Status</h2>
                
                <div class="overflow-x-auto">
                    <table class="table table-zebra w-full">
                        <thead>
                            <tr>
                                <th>Due Date</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Paid Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for payment in rent_payments %}
                            <tr>
                                <td>{{ payment.due_date }}</td>
                                <td>${{ payment.amount }}</td>
                                <td>
                                    <span class="badge {% if payment.status == 'paid' %}badge-success{% elif payment.status == 'due' %}badge-warning{% else %}badge-error{% endif %}">
                                        {{ payment.status|title }}
                                    </span>
                                </td>
                                <td>{% if payment.paid_date %}{{ payment.paid_date }}{% else %}â€”{% endif %}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center">No rent records found.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}
            
            <!-- Management Alerts -->
            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 theme-transition">
                <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Management Alerts</h2>
                
                {% if alerts %}
                <div class="space-y-4">
                    {% for alert in alerts %}
                    <div class="bg-blue-50 dark:bg-blue-900/30 border-l-4 border-blue-500 p-4 rounded">
                        <h3 class="font-semibold text-blue-800 dark:text-blue-200">{{ alert.title }}</h3>
                        <p class="text-blue-700 dark:text-blue-300 mt-1">{{ alert.message }}</p>
                        <p class="text-xs text-blue-600 dark:text-blue-400 mt-2">{{ alert.created_at }}</p>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-gray-600 dark:text-slate-400">No alerts at this time.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
